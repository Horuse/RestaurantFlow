<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:RestaurantFlow.Client.ViewModels"
        xmlns:views="using:RestaurantFlow.Client.Views"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1400" d:DesignHeight="900"
        x:Class="RestaurantFlow.Client.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="RestaurantFlow Client"
        WindowState="Maximized">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid>
        <!-- Header -->
        <Border Height="80" VerticalAlignment="Top" Background="#DA291C" 
                CornerRadius="0,0,20,20" ZIndex="10">
            <Grid ColumnDefinitions="Auto,*,Auto" Margin="30,0">
                <!-- Categories -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" 
                            VerticalAlignment="Center" Spacing="15"
                            IsVisible="{Binding IsMenuView}">
                    <ItemsControl ItemsSource="{Binding Categories}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" Spacing="10"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Content="{Binding Name}"
                                        Background="Transparent"
                                        BorderBrush="White"
                                        BorderThickness="2"
                                        Foreground="White"
                                        Padding="15,8"
                                        CornerRadius="20"
                                        FontWeight="SemiBold"
                                        Command="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).SelectCategoryCommand}"
                                        CommandParameter="{Binding}">
                                    <Button.Styles>
                                        <Style Selector="Button:pointerover">
                                            <Setter Property="Background" Value="#FFC72C"/>
                                            <Setter Property="Foreground" Value="#DA291C"/>
                                        </Style>
                                    </Button.Styles>
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>

                <!-- Back Button (visible only in cart view) -->
                <Button Grid.Column="0" 
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderBrush="White"
                        BorderThickness="2"
                        Foreground="White"
                        Padding="15,8"
                        CornerRadius="20"
                        FontWeight="SemiBold"
                        Content="â† ÐÐ°Ð·Ð°Ð´ Ð´Ð¾ Ð¼ÐµÐ½ÑŽ"
                        Command="{Binding CartViewModel.BackToMenuCommand}"
                        IsVisible="{Binding IsCartView}">
                    <Button.Styles>
                        <Style Selector="Button:pointerover">
                            <Setter Property="Background" Value="#FFC72C"/>
                            <Setter Property="Foreground" Value="#DA291C"/>
                        </Style>
                    </Button.Styles>
                </Button>

                <!-- Title -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="ðŸ” McDonald's" FontSize="24" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"
                               IsVisible="{Binding IsMenuView}"/>
                    <TextBlock Text="ðŸ›’ Ð’Ð°Ñˆ ÐºÐ¾ÑˆÐ¸Ðº" FontSize="24" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"
                               IsVisible="{Binding IsCartView}"/>
                    <TextBlock Text="{Binding CartService.TotalItems, StringFormat='{}{0} Ñ‚Ð¾Ð²Ð°Ñ€Ñ–Ð²'}" 
                               FontSize="12" Foreground="#FFE4B8" HorizontalAlignment="Center"
                               IsVisible="{Binding IsCartView}"/>
                    <TextBlock Text="âœ“ Ð—Ð°Ð¼Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ðµ" FontSize="24" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"
                               IsVisible="{Binding IsOrderSuccessView}"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" VerticalAlignment="Center" IsVisible="{Binding !IsTableSetupView}">
                    <TextBlock Text="Ð¡Ñ‚Ð¾Ð»Ð¸Ðº â„–" Foreground="White" FontSize="12" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding TableNumber}" 
                               FontSize="18"
                               FontWeight="Bold"
                               Foreground="White"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <Grid Margin="0,100,0,0">
            <views:MenuView IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).IsMenuView}" 
                           DataContext="{Binding $parent[Window].DataContext}"/>
            
            <views:CartView IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).IsCartView}" 
                           DataContext="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).CartViewModel}"/>

            
            <views:OrderSuccessView IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).IsOrderSuccessView}" 
                                   DataContext="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).OrderSuccessViewModel}"/>
                                   
            <views:TableSetupView IsVisible="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).IsTableSetupView}" 
                                 DataContext="{Binding $parent[Window].((vm:MainWindowViewModel)DataContext).TableSetupViewModel}"
                                 ZIndex="100"/>
        </Grid>
        
        <Button VerticalAlignment="Bottom" 
                HorizontalAlignment="Center"
                Background="#DA291C"
                Foreground="White"
                BorderThickness="0"
                CornerRadius="30"
                Padding="30,15"
                FontSize="18"
                FontWeight="Bold"
                Margin="0,0,0,30"
                Command="{Binding OpenCartCommand}"
                IsVisible="{Binding IsMenuView}"
                ZIndex="20">
            <Button.Styles>
                <Style Selector="Button:pointerover">
                    <Setter Property="Background" Value="#B8251C"/>
                </Style>
            </Button.Styles>
            <StackPanel Orientation="Horizontal" Spacing="10">
                <TextBlock Text="ÐšÐ¾ÑˆÐ¸Ðº"/>
                <Border Background="#FFC72C" 
                        CornerRadius="10" 
                        Padding="8,4">
                    <TextBlock Text="{Binding CartService.TotalItems}" 
                               Foreground="#DA291C" 
                               FontWeight="Bold" 
                               FontSize="12"/>
                </Border>
                <TextBlock Text="{Binding CartService.TotalPrice, StringFormat='â‚´{0:F2}'}"/>
            </StackPanel>
        </Button>
    </Grid>
</Window>