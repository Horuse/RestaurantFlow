<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:shadui="clr-namespace:ShadUI;assembly=ShadUI"
             xmlns:vm="using:RestaurantFlow.Server.ViewModels"
             xmlns:converters="using:RestaurantFlow.Server.Converters"
             mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="600"
             x:Class="RestaurantFlow.Server.Views.MenuView"
             x:DataType="vm:MenuViewModel">

    <UserControl.Resources>
        <converters:BoolToColorConverter x:Key="BoolToColorConverter"/>
        <converters:BoolToAvailabilityTextConverter x:Key="BoolToAvailabilityTextConverter"/>
    </UserControl.Resources>

    <ScrollViewer HorizontalScrollBarVisibility="Auto">
        <StackPanel HorizontalAlignment="Center" Spacing="16" Width="1100" Margin="20">
            
            <Grid ColumnDefinitions="* Auto">
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                    <Button Classes="Secondary" 
                            Content="ÐžÐ½Ð¾Ð²Ð¸Ñ‚Ð¸"
                            Command="{Binding RefreshDataCommand}">
                        <shadui:ButtonAssist.Icon>
                            <TextBlock Classes="LucideIcon" Text="&#57732;" Margin="0,0,6,0" />
                        </shadui:ButtonAssist.Icon>
                    </Button>
                    
                    <Button Classes="Primary" 
                            Content="Ð”Ð¾Ð´Ð°Ñ‚Ð¸ ÑÑ‚Ñ€Ð°Ð²Ñƒ"
                            Command="{Binding AddNewMenuItemCommand}"/>
                </StackPanel>
            </Grid>
            
            <DataGrid CanUserReorderColumns="False"
                      CanUserSortColumns="True"
                      GridLinesVisibility="Horizontal"
                      ItemsSource="{Binding MenuItems}"
                      SelectionMode="Single"
                      BorderThickness="1"
                      CornerRadius="8">
                
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" 
                                        Binding="{Binding Id}" 
                                        Width="60"
                                        IsReadOnly="True"/>
                    
                    <DataGridTextColumn Header="ÐÐ°Ð·Ð²Ð°" 
                                        Binding="{Binding Name}" 
                                        Width="200"
                                        IsReadOnly="True"/>
                    
                    <DataGridTextColumn Header="ÐžÐ¿Ð¸Ñ" 
                                        Binding="{Binding Description}" 
                                        Width="*"
                                        MinWidth="250"
                                        IsReadOnly="True"/>
                    
                    <DataGridTextColumn Header="Ð¦Ñ–Ð½Ð° (Ð³Ñ€Ð½)" 
                                        Binding="{Binding Price, StringFormat=F2}" 
                                        Width="100"
                                        IsReadOnly="True"/>
                    
                    <DataGridTextColumn Header="Ð§Ð°Ñ Ð¿Ñ€Ð¸Ð³Ð¾Ñ‚ÑƒÐ²Ð°Ð½Ð½Ñ (Ñ…Ð²)" 
                                        Binding="{Binding EstimatedCookingTimeMinutes}" 
                                        Width="150"
                                        IsReadOnly="True"/>
                    
                    <DataGridCheckBoxColumn Header="Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾" 
                                           Binding="{Binding IsAvailable}" 
                                           Width="80"/>
                    
                    <DataGridTemplateColumn Header="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border Padding="4,2" 
                                       CornerRadius="4"
                                       Background="{Binding IsCurrentlyAvailable, Converter={StaticResource BoolToColorConverter}}"
                                       HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding IsCurrentlyAvailable, Converter={StaticResource BoolToAvailabilityTextConverter}}" 
                                              Foreground="White" 
                                              FontSize="10"
                                              FontWeight="SemiBold"/>
                                </Border>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn CanUserResize="False" CanUserSort="False" Header="Ð”Ñ–Ñ—" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <Button Content="âœï¸"
                                            Command="{Binding $parent[UserControl].((vm:MenuViewModel)DataContext).EditMenuItemCommand}"
                                            CommandParameter="{Binding}"
                                            Classes="btn btn-outline"
                                            Width="30"
                                            Height="30"
                                            ToolTip.Tip="Ð ÐµÐ´Ð°Ð³ÑƒÐ²Ð°Ñ‚Ð¸"/>
                                    <Button Content="ðŸ—‘ï¸"
                                            Command="{Binding $parent[UserControl].((vm:MenuViewModel)DataContext).DeleteMenuItemCommand}"
                                            CommandParameter="{Binding}"
                                            Classes="btn btn-outline"
                                            Width="30"
                                            Height="30"
                                            ToolTip.Tip="Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
            
            <Border IsVisible="{Binding IsLoading}" 
                    CornerRadius="8"
                    Padding="32"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="16">
                    <TextBlock Text="â³" FontSize="32" HorizontalAlignment="Center"/>
                    <TextBlock Text="Ð—Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñ Ð¼ÐµÐ½ÑŽ..." HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>